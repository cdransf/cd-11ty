{% assign hidePagination = count or data.pages.size <= 1 %}
<div class="watching grid{% if hidePagination %} no-pagination {% endif %}">
  {% assign items = data.items | default: mediaItems %}
  {% for item in items limit: count %}
    {% capture alt %}{{ item.title | escape }} ({{ item.year }}){% endcapture %}
    <a href="{{ item.url }}">
      <div class="watching item shadow">
        <div class="meta-text">
          {% if item.type == 'movie' %}
            <div class="header">{{ item.title }}</div>
            <div class="subheader flex-centered gap-xs">
              {{ item.year }}
              {% if rating and item.rating %}
                <span class="rating"> ({{ item.rating }})</span>
              {% endif %}
            </div>
          {% else %}
            <div class="header">{{ item.name }}</div>
          {% endif %}
        </div>
        {%- capture loadingStrategy -%}
          {%- if loading -%}{{ loading }}{%- else -%}lazy{%- endif -%}
        {%- endcapture -%}
        <img
          srcset="
            https://coryd.dev/.netlify/images/?url={{ item.backdrop }}&fit=cover&w=256&h=144&fm=webp&q=85 256w,
            https://coryd.dev/.netlify/images/?url={{ item.backdrop }}&fit=cover&w=512&h=288&fm=webp&q=85 512w,
            https://coryd.dev/.netlify/images/?url={{ item.backdrop }}&fit=cover&w=1024&h=576&fm=webp&q=85 1024w,
            https://coryd.dev/.netlify/images/?url={{ item.backdrop }}&fit=cover&w=2048&h=1152&fm=webp&q=85 2048w
          "
          sizes="(max-width: 450px) 256px,
            (max-width: 850px) 512px,
            (max-width: 1000px) 1024px,
            2048px"
          src="https://coryd.dev/.netlify/images/?url={{ item.backdrop }}&fit=cover&w=2048&h=1152&fm=webp&q=85"
          alt="{{ alt }}"
          loading="{{ loadingStrategy }}"
          decoding="async"
          width="256"
          height="144"
        />
      </div>
    </a>
  {% endfor %}
</div>
{% unless hidePagination %}
  {% render "partials/widgets/paginator.liquid", pagination:data %}
{% endunless %}